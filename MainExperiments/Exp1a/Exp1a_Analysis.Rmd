---
title: "Experiment 1a"
author: "Simon Stephan"
output:  
  html_document:
    number_sections: true
    toc: true  
    collapsed: false
    toc_float: true
    smooth_scroll: false
    toc_depth: 3
---

```{r setup, include=FALSE}
# packages
library(ez)
library(reshape2)
library(reshape)
library(ggplot2)
library(plyr)
library(pastecs)
library(ez)
library(data.table)
#library(Rcmdr)
#Commander()

library(showtext)

font_add_google("Poppins", "Poppins")
font_add_google("Roboto Mono", "Roboto Mono")
showtext_auto()
##########################################Data Managment############################
# read in the data file 

#tdata.wide <- read.delim("dummy_data.txt", header=TRUE, sep="\t", na.strings="NA", dec=".", strip.white=TRUE)
tdata <- read.delim("Exp1a_Data.txt", header=TRUE, sep="\t", na.strings="NA", dec=".", strip.white=TRUE)

```

# Results 

## Demographics

```{r}
# demographics 
min(tdata$Age)
max(tdata$Age)
mean(tdata$Age)
sd(tdata$Age)
```
above we see: min age, max age, mean age, and sd of age. 


```{r}
# 1 = male, 2 = female, 3 = other
table(tdata$Sex)
```

1 = male, 2 = female. 



```{r}
# Data preparation

# reorder factor 
tdata$type_effect <- factor(tdata$type_effect, levels = c("similar", "diverse"))

# reorder factor 
tdata$target_cause <- factor(tdata$target_cause, levels = c("single", "multi"), 
                            labels = c("single-effect cause", "multiple-effects cause"))

# reorder factor 
tdata$target_effect <- factor(tdata$target_effect, levels = c("first", "second", "third"), 
                                     labels = c("first effect", "second effect", "third effect"))


# to create a chart, the data must be in long format and only contain the relevant dependent variables

# make a subset with only the relevant dvs 

tdata_sub <- subset(tdata, select = 1:6)

# recode dependent variables (to have values between 0 and 1)

tdata_sub$Value <- (tdata_sub$Value) * 0.01
```

# Graphs

```{r, echo = FALSE}

myTheme <- theme(plot.title = element_text(face="bold", size = 22),
        axis.title.x = element_text(face = "bold", size = 20),
        axis.title.y = element_text(face = "bold", size = 20),
        axis.text.x = element_text(size = 18, angle = 0), 
        axis.text.y = element_text(size = 14, angle = 0),
        legend.text = element_text(size = 18),
        legend.title = element_text(face = "bold", size = 18),
        strip.text.x = element_text(size = 18),
        #panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line.x = element_line(colour = "black"), 
        axis.line.y = element_line(colour = "black"),
        axis.text = element_text(colour ="black"), 
        axis.ticks = element_line(colour ="black"))


theme_set(theme_light(base_size = 20, base_family = "Poppins"))

library(see)
## first, turn sID into a factor
tdata_sub$sID <- factor(tdata_sub$sID)

pd <- position_dodge(width = 0.3)

tdata_sub$valueJitter <- jitter(tdata_sub$Value, factor = 1, amount = 0.04)

theme_set(theme_light(base_size = 20, base_family = "Poppins"))

# new labes for the facets 
effects.labs <- c("Multiple effects from same domain", "Multiple effects from different domains")
names(effects.labs) <- c("similar", "diverse")

g <- ggplot(tdata_sub, aes(x=target_cause, y=valueJitter, color = target_cause, fill = target_cause)) +
  guides(fill=FALSE)+
  facet_grid( ~ type_effect, labeller = labeller(type_effect =effects.labs))+
  #ggtitle("Subjects' causal srength ratings") +
  scale_y_continuous(limits = c(-0.05, 1.05), breaks=seq(0, 1, 0.1), expand = c(0,0)) +
  scale_x_discrete(labels=c("single-effect \n case", "common \n cause")) +
  geom_violinhalf(position=position_dodge(1), alpha = 0.2, color = NA)+
  geom_point(position=position_jitterdodge(dodge.width=0.5), alpha = 0.2) +
  stat_summary(fun.y=mean, colour="black", geom="line", group = 1, size = 1.5, linetype = "solid", alpha = 1)+
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar", width = 0, size = 1, position = position_dodge(width = 0.5), color = "black") +
  stat_summary(fun.y=mean, geom="point", color = "black", shape = 22, size = 4, group=1, alpha = 1, position = position_dodge(width = 0.5))+
  stat_summary(fun.y=median, geom="point", color = "black",  shape = 3, size = 4, group=1, alpha = 1, position = position_dodge(width = 0.5))+
  labs(x = "Target Cause", y = "Causal Strength Rating") +
  scale_color_manual(name = "Entity",values=c("#fc9272","#3182bd"))+
  scale_fill_manual(name = "Entity",values=c("#fc9272","#3182bd"))+
  theme(legend.position = "none")+
  myTheme
g


#ggsave("results_CC_vs_SE_cont.svg",width=11.5,height=6)
#ggsave("results_CC_vs_SE_cont.pdf",width=11.5,height=6)
```

A clear dilution effect. Effects seems to be robust against effect domains.

```{r, echo = FALSE}

myTheme <- theme(plot.title = element_text(face="bold", size = 22),
        axis.title.x = element_text(face = "bold", size = 20),
        axis.title.y = element_text(face = "bold", size = 20),
        axis.text.x = element_text(size = 18, angle = 0), 
        axis.text.y = element_text(size = 14, angle = 0),
        legend.text = element_text(size = 18),
        legend.title = element_text(face = "bold", size = 18),
        strip.text.x = element_text(size = 18),
        #panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(), 
        panel.background = element_blank(), 
        axis.line.x = element_line(colour = "black"), 
        axis.line.y = element_line(colour = "black"),
        axis.text = element_text(colour ="black"), 
        axis.ticks = element_line(colour ="black"))


theme_set(theme_light(base_size = 20, base_family = "Poppins"))

library(see)
## first, turn sID into a factor
tdata_sub$sID <- factor(tdata_sub$sID)

pd <- position_dodge(width = 0.3)

tdata_sub$valueJitter <- jitter(tdata_sub$Value, factor = 1, amount = 0.04)

theme_set(theme_light(base_size = 20, base_family = "Poppins"))

# new labes for the facets 
effects.labs <- c("Multiple effects from same domain", "Multiple effects from different domains")
names(effects.labs) <- c("similar", "diverse")

g <- ggplot(tdata_sub, aes(x=target_cause, y=valueJitter, color = target_cause, fill = target_cause)) +
  guides(fill=FALSE)+
  facet_grid(type_effect ~ target_effect, labeller = labeller(type_effect =effects.labs))+
  #ggtitle("Subjects' causal srength ratings") +
  scale_y_continuous(limits = c(-0.05, 1.05), breaks=seq(0, 1, 0.1), expand = c(0,0)) +
  scale_x_discrete(labels=c("single-effect \n cause", "common \n case")) +
  geom_violinhalf(position=position_dodge(1), alpha = 0.2, color = NA)+
  geom_point(position=position_jitterdodge(dodge.width=0.5), alpha = 0.2) +
  stat_summary(fun.y=mean, colour="black", geom="line", group = 1, size = 1.5, linetype = "solid", alpha = 1)+
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar", width = 0, size = 1, position = position_dodge(width = 0.5), color = "black") +
  stat_summary(fun.y=mean, geom="point", color = "black", shape = 22, size = 4, group=1, alpha = 1, position = position_dodge(width = 0.5))+
  stat_summary(fun.y=median, geom="point", color = "black",  shape = 3, size = 4, group=1, alpha = 1, position = position_dodge(width = 0.5))+
  labs(x = "Target Cause", y = "Causal Strength Rating") +
  scale_color_manual(name = "Entity",values=c("#3182bd", "#fc9272"))+
  scale_fill_manual(name = "Entity",values=c("#3182bd", "#fc9272"))+
  theme(legend.position = "none")+
  myTheme
g


#ggsave("results_CC_vs_SE_cont_target_effect.svg",width=11.5,height=10)
#ggsave("results_CC_vs_SE_cont_target_effect.pdf",width=11.5,height=10)
```

Effect also occurs for all target effects.





# Descriptive Stats

```{r, echo = FALSE, warning = FALSE, message = FALSE}

################################################################################################################
##################################### Statistical Analyses #####################################################
################################################################################################################
library(pastecs)
library(lme4)
library(nlme)
library(ez)


##################################### Create descriptive stats ###################################

by(tdata_sub$Value, list(tdata_sub$target_cause, tdata_sub$type_effect), stat.desc , basic = FALSE)

##################################### Model ######################################################
```

# Statistical Test

```{r}
# ANOVA 

library(afex)
library(emmeans)

a1 <- aov_car(Value ~ target_cause*target_cause_color*type_effect*target_effect + Error(sID), tdata_sub)
a1
```

Main effect of target cause, as predicted by theory. Also a smaller main effect for type of effect (i.e., effect domains). Figures show that effect is a bit bitter for effects from the same domain. There also was a main effect target cause color, which was not predicted. However. The following graph checks this main effect: 

```{r}
g <- ggplot(tdata_sub, aes(x=target_cause, y=valueJitter, color = target_cause, fill = target_cause)) +
  guides(fill=FALSE)+
  facet_grid( ~ target_cause_color)+
  #ggtitle("Subjects' causal srength ratings") +
  scale_y_continuous(limits = c(-0.05, 1.05), breaks=seq(0, 1, 0.1), expand = c(0,0)) +
  scale_x_discrete(labels=c("single-effect \n cause", "common \n case")) +
  geom_violinhalf(position=position_dodge(1), alpha = 0.2, color = NA)+
  geom_point(position=position_jitterdodge(dodge.width=0.5), alpha = 0.2) +
  stat_summary(fun.y=mean, colour="black", geom="line", group = 1, size = 1.5, linetype = "solid", alpha = 1)+
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar", width = 0, size = 1, position = position_dodge(width = 0.5), color = "black") +
  stat_summary(fun.y=mean, geom="point", color = "black", shape = 22, size = 4, group=1, alpha = 1, position = position_dodge(width = 0.5))+
  stat_summary(fun.y=median, geom="point", color = "black",  shape = 3, size = 4, group=1, alpha = 1, position = position_dodge(width = 0.5))+
  labs(x = "Target Cause", y = "Causal Strength Rating") +
  scale_color_manual(name = "Entity",values=c("#3182bd", "#fc9272"))+
  scale_fill_manual(name = "Entity",values=c("#3182bd", "#fc9272"))+
  theme(legend.position = "none")+
  myTheme
g

```

As can be seen, the effect was obtained because ratings tended to be higher in the "red" condition. What is important is that there are no significant interaction effects.

__Test the dilution effects:__

```{r}
############### 
# a conditional analysis 

# Means for the different conditions

ls2 <- lsmeans(a1, c("target_cause"), by = "type_effect") # group means by between-condition
ls2

# Tets

# simple main effects 

t1 <- pairs(ls2) # compares rep-measure differences separately for each between-factor level
t1
# interaction contrast 
pairs(pairs(ls2), by = NULL)

#test(pairs(pairs(ls2), by = NULL), joint = TRUE) # This reproduces the F-Value of the ANOVA interaction


#lsmip(a1, High_Strength_Component ~ variable) # lsemans can also produce graphs
```


```{r}
# Get CIs for the effects

confint(t1)
```

__Make difference plots:__ 


```{r}
# Plot the effect

# compute the confidence interval for the singular causation differences in each between-subject condition

# similar effects

t <- qt(0.975, 116, lower.tail = TRUE, log.p = FALSE)
#t

effect <- "Mdiff"
Mdiff <- 0.168
SE <- 0.0602
CI <- SE*t
CI_low <- Mdiff - CI
CI_up <- Mdiff + CI

Mdiff
CI_low
CI_up



# Plot 

myTheme <- theme(plot.title = element_text(face="bold", size = 22),
        axis.title.x = element_text(face = "bold", size = 20),
        axis.title.y = element_text(face = "bold", size = 20),
        axis.text.x = element_text(size = 18, angle = 0), 
        axis.text.y = element_text(size = 25, angle = 0),
        legend.text = element_text(size = 18),
        legend.title = element_text(face = "bold", size = 18),
        strip.text.x = element_text(size = 18),
        #panel.grid.major = element_blank(), 
        #panel.grid.minor = element_blank(), 
        #panel.background = element_blank(), 
        axis.line.x = element_line(colour = "black"), 
        axis.line.y = element_line(colour = "black"),
        axis.text = element_text(colour ="black"), 
        axis.ticks = element_line(colour ="black"))

theme_set(theme_light(base_size = 30, base_family = "Poppins"))



barchart <- ggplot()+
  myTheme+
  #guides(fill=FALSE)+
  #facet_wrap(~Latency + SampleSize, ncol=2)+
  #ggtitle("Mean difference (95% CI)") +
  #coord_cartesian(ylim=c(-0.1,2)) + 
  scale_y_continuous(limits = c(-0.1, 0.5), breaks=seq(-0.1, 0.5, 0.1), expand = c(0,0)) +
  scale_x_discrete(labels=c("r")) +
  #annotate("rect", xmin=1.7, xmax=2.3, ymin=0.95, ymax=1.05, color="#31a354", fill = "white", size = 1) +
  #stat_summary(fun.y=mean, colour="grey20", geom="point", shape = 21, size = 3)+
  #stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = "black")+
  #stat_summary(fun.data = mean_cl_boot, geom = "errorbar", position = position_dodge(width = 0.90), width = 0.2) +
  #geom_jitter(width = 0.3, height = 0.02, alpha = 0.6, colour = "red") +
  #ggtitle("Means (95% bootstr. CIs)") +
  #theme(axis.text.x = element_text(size = 10, angle = 0, hjust = 0.5))+
  labs(x= "", y = "Mean difference") +
  #scale_color_manual(values=c("#005083",  "#f0b64d"))# +
  #scale_fill_manual(values=c("#969696",  "#969696"))
  #annotate("point", x = 1, y = 100, colour = "firebrick", size = 2)+
  #annotate(xmin = -Inf, xmax = Inf, ymin = 4.77-1.96*0.297, ymax = 4.77+1.96*0.297, geom = "rect", alpha = 0.2, fill = "firebrick")+
  #annotate(xmin = -Inf, xmax = Inf, ymin = 5.02-1.96*0.372, ymax = 5.02+1.96*0.372, geom = "rect", alpha = 0.2, fill = "blue")+
  #annotate(geom = "hline",yintercept = 100, y = 100, color = "red")+
  annotate("pointrange", x = 1, y = Mdiff, ymin = CI_low, ymax = CI_up, colour = "black", size = 1.5, shape = 24, fill = "darkgrey")+
  #annotate("pointrange", x = 2, y = 5.02, ymin = 5.02-1.96*0.372, ymax = 5.02+1.96*0.372, colour = "blue", size = 0.8, shape = 15)+
  #annotate("text", x = 0.5, y = 2.6, family = "Poppins", size = 6, color = "gray20", label = "Impfeffekt")+
  #geom_curve(aes(x = 0.5, y = 3, xend = 0.9, yend = 4),arrow = arrow(length = unit(0.03, "npc")),color = "gray20", curvature = +0.2)+
  #annotate("text", x = 1.8, y = 2.6, family = "Poppins", size = 6, color = "gray20", label = "Dosierungseffekt")+
  #geom_curve(aes(x = 1.8, y = 3, xend = 2, yend = 4),arrow = arrow(length = unit(0.03, "npc")),color = "gray20", curvature = +0.2)+
  annotate(geom = "hline",yintercept = 0, y = 0, color = "red", size = 1.2)+
  theme(plot.background = element_rect(
    fill = "white",
    colour = "black",
    size = 1
  ))


barchart

#ggsave("delta_similar.svg",width=2.5,height=4)
#ggsave("delta_similar.pdf",width=2.5,height=4)
```

```{r}
# compute the confidence interval for the singular causation differences in each between-subject condition

# different effects

t <- qt(0.975, 116, lower.tail = TRUE, log.p = FALSE)
#t

effect <- "Mdiff"
Mdiff <- 0.221
SE <- 0.0602
CI <- SE*t
CI_low <- Mdiff - CI
CI_up <- Mdiff + CI

Mdiff
CI_low
CI_up



# Plot 

myTheme <- theme(plot.title = element_text(face="bold", size = 22),
        axis.title.x = element_text(face = "bold", size = 20),
        axis.title.y = element_text(face = "bold", size = 20),
        axis.text.x = element_text(size = 18, angle = 0), 
        axis.text.y = element_text(size = 25, angle = 0),
        legend.text = element_text(size = 18),
        legend.title = element_text(face = "bold", size = 18),
        strip.text.x = element_text(size = 18),
        #panel.grid.major = element_blank(), 
        #panel.grid.minor = element_blank(), 
        #panel.background = element_blank(), 
        axis.line.x = element_line(colour = "black"), 
        axis.line.y = element_line(colour = "black"),
        axis.text = element_text(colour ="black"), 
        axis.ticks = element_line(colour ="black"))

theme_set(theme_light(base_size = 30, base_family = "Poppins"))



barchart <- ggplot()+
  myTheme+
  #guides(fill=FALSE)+
  #facet_wrap(~Latency + SampleSize, ncol=2)+
  #ggtitle("Mean difference (95% CI)") +
  #coord_cartesian(ylim=c(-0.1,2)) + 
  scale_y_continuous(limits = c(-0.1, 0.5), breaks=seq(-0.1, 0.5, 0.1), expand = c(0,0)) +
  scale_x_discrete(labels=c("r")) +
  #annotate("rect", xmin=1.7, xmax=2.3, ymin=0.95, ymax=1.05, color="#31a354", fill = "white", size = 1) +
  #stat_summary(fun.y=mean, colour="grey20", geom="point", shape = 21, size = 3)+
  #stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = "black")+
  #stat_summary(fun.data = mean_cl_boot, geom = "errorbar", position = position_dodge(width = 0.90), width = 0.2) +
  #geom_jitter(width = 0.3, height = 0.02, alpha = 0.6, colour = "red") +
  #ggtitle("Means (95% bootstr. CIs)") +
  #theme(axis.text.x = element_text(size = 10, angle = 0, hjust = 0.5))+
  labs(x= "", y = "Mean difference") +
  #scale_color_manual(values=c("#005083",  "#f0b64d"))# +
  #scale_fill_manual(values=c("#969696",  "#969696"))
  #annotate("point", x = 1, y = 100, colour = "firebrick", size = 2)+
  #annotate(xmin = -Inf, xmax = Inf, ymin = 4.77-1.96*0.297, ymax = 4.77+1.96*0.297, geom = "rect", alpha = 0.2, fill = "firebrick")+
  #annotate(xmin = -Inf, xmax = Inf, ymin = 5.02-1.96*0.372, ymax = 5.02+1.96*0.372, geom = "rect", alpha = 0.2, fill = "blue")+
  #annotate(geom = "hline",yintercept = 100, y = 100, color = "red")+
  annotate("pointrange", x = 1, y = Mdiff, ymin = CI_low, ymax = CI_up, colour = "black", size = 1.5, shape = 24, fill = "darkgrey")+
  #annotate("pointrange", x = 2, y = 5.02, ymin = 5.02-1.96*0.372, ymax = 5.02+1.96*0.372, colour = "blue", size = 0.8, shape = 15)+
  #annotate("text", x = 0.5, y = 2.6, family = "Poppins", size = 6, color = "gray20", label = "Impfeffekt")+
  #geom_curve(aes(x = 0.5, y = 3, xend = 0.9, yend = 4),arrow = arrow(length = unit(0.03, "npc")),color = "gray20", curvature = +0.2)+
  #annotate("text", x = 1.8, y = 2.6, family = "Poppins", size = 6, color = "gray20", label = "Dosierungseffekt")+
  #geom_curve(aes(x = 1.8, y = 3, xend = 2, yend = 4),arrow = arrow(length = unit(0.03, "npc")),color = "gray20", curvature = +0.2)+
  annotate(geom = "hline",yintercept = 0, y = 0, color = "red", size = 1.2)+
  theme(plot.background = element_rect(
    fill = "white",
    colour = "black",
    size = 1
  ))


barchart

#ggsave("delta_different.svg",width=2.5,height=4)
#ggsave("delta_different.pdf",width=2.5,height=4)
```


```{r}
# Interaction 

t <- qt(0.975, 116, lower.tail = TRUE, log.p = FALSE)
#t

effect <- "Mdiff"
Mdiff <- 0.053 
SE <- 0.0851
CI <- SE*t
CI_low <- Mdiff - CI
CI_up <- Mdiff + CI

Mdiff
CI_low
CI_up



# Plot 

myTheme <- theme(plot.title = element_text(face="bold", size = 22),
        axis.title.x = element_text(face = "bold", size = 20),
        axis.title.y = element_text(face = "bold", size = 20),
        axis.text.x = element_text(size = 18, angle = 0), 
        axis.text.y = element_text(size = 25, angle = 0),
        legend.text = element_text(size = 18),
        legend.title = element_text(face = "bold", size = 18),
        strip.text.x = element_text(size = 18),
        #panel.grid.major = element_blank(), 
        #panel.grid.minor = element_blank(), 
        #panel.background = element_blank(), 
        axis.line.x = element_line(colour = "black"), 
        axis.line.y = element_line(colour = "black"),
        axis.text = element_text(colour ="black"), 
        axis.ticks = element_line(colour ="black"))

theme_set(theme_light(base_size = 30, base_family = "Poppins"))



barchart <- ggplot()+
  myTheme+
  #guides(fill=FALSE)+
  #facet_wrap(~Latency + SampleSize, ncol=2)+
  #ggtitle("Mean difference (95% CI)") +
  #coord_cartesian(ylim=c(-0.1,2)) + 
  scale_y_continuous(limits = c(-0.2, 0.25), breaks=seq(-0.2, 0.25, 0.1), expand = c(0,0)) +
  scale_x_discrete(labels=c("r")) +
  #annotate("rect", xmin=1.7, xmax=2.3, ymin=0.95, ymax=1.05, color="#31a354", fill = "white", size = 1) +
  #stat_summary(fun.y=mean, colour="grey20", geom="point", shape = 21, size = 3)+
  #stat_summary(fun.y = mean, geom = "bar", position = "dodge", colour = "black")+
  #stat_summary(fun.data = mean_cl_boot, geom = "errorbar", position = position_dodge(width = 0.90), width = 0.2) +
  #geom_jitter(width = 0.3, height = 0.02, alpha = 0.6, colour = "red") +
  #ggtitle("Means (95% bootstr. CIs)") +
  #theme(axis.text.x = element_text(size = 10, angle = 0, hjust = 0.5))+
  labs(x= "", y = "Delta Mean difference") +
  #scale_color_manual(values=c("#005083",  "#f0b64d"))# +
  #scale_fill_manual(values=c("#969696",  "#969696"))
  #annotate("point", x = 1, y = 100, colour = "firebrick", size = 2)+
  #annotate(xmin = -Inf, xmax = Inf, ymin = 4.77-1.96*0.297, ymax = 4.77+1.96*0.297, geom = "rect", alpha = 0.2, fill = "firebrick")+
  #annotate(xmin = -Inf, xmax = Inf, ymin = 5.02-1.96*0.372, ymax = 5.02+1.96*0.372, geom = "rect", alpha = 0.2, fill = "blue")+
  #annotate(geom = "hline",yintercept = 100, y = 100, color = "red")+
  annotate("pointrange", x = 1, y = Mdiff, ymin = CI_low, ymax = CI_up, colour = "black", size = 1.5, shape = 23, fill = "darkgrey")+
  #annotate("pointrange", x = 2, y = 5.02, ymin = 5.02-1.96*0.372, ymax = 5.02+1.96*0.372, colour = "blue", size = 0.8, shape = 15)+
  #annotate("text", x = 0.5, y = 2.6, family = "Poppins", size = 6, color = "gray20", label = "Impfeffekt")+
  #geom_curve(aes(x = 0.5, y = 3, xend = 0.9, yend = 4),arrow = arrow(length = unit(0.03, "npc")),color = "gray20", curvature = +0.2)+
  #annotate("text", x = 1.8, y = 2.6, family = "Poppins", size = 6, color = "gray20", label = "Dosierungseffekt")+
  #geom_curve(aes(x = 1.8, y = 3, xend = 2, yend = 4),arrow = arrow(length = unit(0.03, "npc")),color = "gray20", curvature = +0.2)+
  annotate(geom = "hline",yintercept = 0, y = 0, color = "red", size = 1.2)+
  theme(plot.background = element_rect(
    fill = "white",
    colour = "black",
    size = 1
  ))


barchart

#ggsave("interaction.svg",width=2.5,height=4)
#ggsave("interaction.pdf",width=2.5,height=4)
```


__Compute Cohen's ds.__ 

```{r}
library(dplyr) # for pipe operator
# using the esc package because it gives SE of the ES directly
library(esc)



# condition: same domains

# subset for the four panels shown in the figure
same_domain <- subset(tdata_sub, type_effect == "similar")



m1 <- same_domain %>%
          filter(target_cause == "single-effect cause")%>%
          summarize(Mean1 = mean(Value))

sd1 <- same_domain %>%
          filter(target_cause == "single-effect cause")%>%
          summarize(SD1 = sd(Value))


m2 <- same_domain %>%
          filter(target_cause == "multiple-effects cause")%>%
          summarize(Mean2 = mean(Value))

sd2 <- same_domain %>%
          filter(target_cause == "multiple-effects cause")%>%
          summarize(SD2 = sd(Value))



esc_mean_sd(
  grp1m = m1[,1], grp1sd = sd1[,1], grp1n = 30,
  grp2m = m2[,1], grp2sd = sd2[,1], grp2n = 30,
  es.type = "d"
)
```


```{r}
# using the esc package because it gives SE of the ES directly
library(esc)


# condition: diff domains

diff_domain <- subset(tdata_sub, type_effect == "diverse")

m1 <- diff_domain %>%
          filter(target_cause == "single-effect cause")%>%
          summarize(Mean1 = mean(Value))

sd1 <- diff_domain %>%
          filter(target_cause == "single-effect cause")%>%
          summarize(SD1 = sd(Value))


m2 <- diff_domain %>%
          filter(target_cause == "multiple-effects cause")%>%
          summarize(Mean2 = mean(Value))

sd2 <- diff_domain %>%
          filter(target_cause == "multiple-effects cause")%>%
          summarize(SD2 = sd(Value))



esc_mean_sd(
  grp1m = m1[,1], grp1sd = sd1[,1], grp1n = 30,
  grp2m = m2[,1], grp2sd = sd2[,1], grp2n = 30,
  es.type = "d"
)


```



```{r}
# using the esc package because it gives SE of the ES directly
library(esc)


# condition: overall

m1 <- tdata_sub %>%
          filter(target_cause == "single-effect cause")%>%
          summarize(Mean1 = mean(Value))

sd1 <- tdata_sub %>%
          filter(target_cause == "single-effect cause")%>%
          summarize(SD1 = sd(Value))


m2 <- tdata_sub %>%
          filter(target_cause == "multiple-effects cause")%>%
          summarize(Mean2 = mean(Value))

sd2 <- tdata_sub %>%
          filter(target_cause == "multiple-effects cause")%>%
          summarize(SD2 = sd(Value))



esc_mean_sd(
  grp1m = m1[,1], grp1sd = sd1[,1], grp1n = 60,
  grp2m = m2[,1], grp2sd = sd2[,1], grp2n = 60,
  es.type = "d"
)
```









